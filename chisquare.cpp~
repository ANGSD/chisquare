/*
  taken from numerical recipeis 2007 third edition

 */


struct Chisqdist : Gamma {
  Doub nu,fac;
  Chisqdist(Doub nnu) : nu(nnu) {
    Constructor. Initialize with .
      fac = 0.693147180559945309*(0.5*nu)+gammln(0.5*nu);
  }
  Doub p(Doub x2) {
    if (x2 <= 0.) throw("bad x2 in Chisqdist");
    return exp(-0.5*(x2-(nu-2.)*log(x2))-fac);
  }
  Doub cdf(Doub x2) {
    if (x2 < 0.) throw("bad x2 in Chisqdist");
    return gammp(0.5*nu,0.5*x2);
  }
  Doub invcdf(Doub p) {
    Return inverse cumulative distribution function.
      if (p < 0. || p >= 1.) throw("bad p in Chisqdist");
    return 2.*invgammp(p,0.5*nu);
  }
};
